<!-- Reset Password template: allows changing password after token verification. -->
<div class="auth-page">

  <div class="header text-center">
    <i class="bi bi-shield-lock-fill icon"></i>
    <h2>إعادة تعيين كلمة المرور</h2>
    <p class="subtitle">تم إرسال الكود إلى:</p>
    <p class="email">{{ email }}</p>
  </div>

  <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="auth-form">

    <!-- Code -->
    <div class="mb-3">
      <label class="form-label">كود التحقق <span class="text-danger">*</span></label>

      <input type="text" class="form-control form-control-lg text-center" placeholder="------" maxlength="6"
        formControlName="code" [class.is-invalid]="isFieldInvalid('code')">

      <div class="invalid-feedback" *ngIf="isFieldInvalid('code')">
        {{ getFieldError('code') }}
      </div>
    </div>

    <!-- New Password -->
    <div class="mb-3">
      <label class="form-label">كلمة المرور الجديدة <span class="text-danger">*</span></label>

      <input type="password" class="form-control form-control-lg" placeholder="********" formControlName="newPassword"
        [class.is-invalid]="isFieldInvalid('newPassword')">

      <div class="invalid-feedback" *ngIf="isFieldInvalid('newPassword')">
        {{ getFieldError('newPassword') }}
      </div>
    </div>

    <!-- Confirm Password -->
    <div class="mb-4">
      <label class="form-label">تأكيد كلمة المرور <span class="text-danger">*</span></label>

      <input type="password" class="form-control form-control-lg" placeholder="********"
        formControlName="confirmPassword" [class.is-invalid]="isFieldInvalid('confirmPassword')">

      <div class="invalid-feedback" *ngIf="isFieldInvalid('confirmPassword')">
        {{ getFieldError('confirmPassword') }}
      </div>
    </div>

    <!-- Submit -->
    <button type="submit" class="btn btn-primary-nav btn-lg w-100"
      [disabled]="resetPasswordForm.invalid || isSubmitting">

      <span *ngIf="!isSubmitting">تعيين كلمة المرور</span>

      <span *ngIf="isSubmitting">
        <span class="spinner-border spinner-border-sm me-2"></span>
        جاري التحديث...
      </span>
    </button>

    <!-- Back -->
    <div class="text-center mt-4">
      <span class="text-muted">هل تذكرت كلمة المرور؟ </span>
      <a routerLink="/login" class="fw-bold">تسجيل الدخول</a>
    </div>

  </form>
</div>
